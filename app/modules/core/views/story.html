<fa-header-footer-layout>
    <fa-modifier fa-size="[undefined, 90]" fa-translate="[0, 0, 1]">
	    <fa-view>
	      <fa-surface>
	      	  <div ng-include="'modules/core/views/navbar.html'"></div>
        </fa-surface>
	    </fa-view>
    </fa-modifier>
    
		<fa-modifier fa-size="[undefined, undefined]" fa-translate="[0, 0, 0]">
		  <fa-scroll-view fa-pipe-from="eventHandler">
				<fa-view fa-index="0" ng-if="mode==='overview'">
					<fa-modifier fa-size="[undefined,{{gridHeight}}]">
						<fa-grid-layout fa-options="gridLayoutOptions">
					    <fa-modifier ng-repeat="story in storiesObject" fa-size="[{{boxSize}}, {{boxSize}}]"  fa-align="[0.5,0]" fa-origin="[0.5,0]">
								<fa-image-surface fa-image-url="{{hostUrl + story.file.url}}" fa-pipe-to="eventHandler" ng-click="changeMode(story,'detail')">
							  </fa-image-surface>
							</fa-modifier>
					  </fa-grid-layout>
				  </fa-modifier>
				</fa-view>

				<fa-view ng-if="mode==='detail'">
				  <!-- story author info -->
					<fa-modifier  fa-align="[0.1,0]" fa-origin="[0.5,0]">
						<fa-image-surface fa-size="[50, 50]" fa-image-url="{{users[selectedStory.ref_user].profile.file.url}}"></fa-image-surface>
						<fa-surface fa-align="[0.5,0]" fa-origin="[0.5,0]" fa-translate="[0,100,0]">{{users[selectedStory.ref_user].profile.name}}</fa-surface>
					</fa-modifier>

					<!-- story body -->
					<fa-modifier fa-size="[500, 500]" fa-align="[0.5,0]" fa-origin="[0.5,0]" fa-translate="[0,50,0]">
						<fa-image-surface fa-image-url="{{hostUrl + selectedStory.file.url}}" fa-pipe-to="eventHandler" ng-click="changeMode(selectedStory,'overview')"></fa-image-surface>
					</fa-modifier>
					<fa-modifier fa-size="[300, true]" fa-align="[0.5,0]" fa-origin="[0.5,0]" fa-translate="[0, 550, 0]">
						<fa-surface fa-pipe-to="eventHandler" >
							<h4>{{selectedStory.text.headline}}</h4>
							<p>{{selectedStory.text.text}}</p>
							<!-- <div ng-if="selectedStory.text.videoUrl">
								<embed-video href="{{selectedStory.text.videoUrl}}"></embed-video>
							</div> -->
						</fa-surface>
					</fa-modifier>

					<!-- comments -->
					<fa-modifier ng-repeat="(commentKey, comment) in commentsObject" fa-size="[undefined,50]" fa-align="[0.5,0]" fa-origin="[0.5,0]" fa-translate="[0, 650 + $index * 50, 0]">
						<fa-surface fa-pipe-to="eventHandler" >
		          <img ng-src="{{users[comment.ref_user].profile.file.url}}" style="width:32px;height:32px;"/>
		          <strong class="comment-user-id">{{users[comment.ref_user].profile.name}}</strong>
		          <span class="text-muted text-small"><em>{{comment.fromNow}}</em></span>
		          <span ng-if="comment.ref_user == user.uid">
		            <p>{{comment.body}}</p>
		          </span>
		         	<p ng-if="comment.ref_user != user.uid">{{comment.body}}</p>
						</fa-surface>					      
					</fa-modifier>
				</fa-view>
			</fa-scroll-view>
		</fa-modifier>

	 <fa-modifier fa-size="[undefined, 90]" fa-translate="[0, 0, 1]">
    <fa-view ng-if="mode==='detail'">
    	<fa-surface fa-pipe-to="eventHandler">
        <div class="comment-body">
          <form name="commentForm" ng-submit="addComment(selectedStory.$id,newComment)" novalidate style="padding-right:30px;">
            <textarea class="form-control" ng-model="newComment.body" placeholder="댓글을 입력하세요.." rows="2"/>
            <button type="submit" class="btn btn-xs btn-success"><i class="fa fa-pencil"></i>댓글 저장</button>
          </form>            
        </div>
	    </fa-surface>
	  </fa-view>
  </fa-modifier>
</fa-header-footer-layout>
